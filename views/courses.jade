extends layout/header
block content
    div(ng-app="postsApp", ng-controller="postsController", ng-cloak, ng-init="init('course')")
        if user
            div.panel.panel-default()
                div.jumbotron
                    if user
                        div(ng-if="user.imageUrl")
                            include users/avatarImage
                        p=params
                        h2 #{user.displayName}
        div(ng-show="permissions && permissions.canEditCourses")
            button.btn.btn-primary(type="Submit" ng-click="addPost()" ) {{addButtonText}}
            div
                div(ng-show="isEditing")
                    div
                        form
                            textarea(name="editor1")
        div.panel.panel-body(ng-repeat="p in posts")
            button.btn.btn-fab.btn-raised.btn-primary.btn-fab-mini(ng-show="permissions && permissions.canEditCourses" data-toggle="modal" data-target="#complete-dialog" type="Submit" ng-click='editPost(p)' )
                i.mdi-image-edit
            p(ng-bind-html="p.data | to_trusted")
        div.modal.fade(id="complete-dialog" tabindex="-1")
            div.modal-dialog
                div.modal-content
                    div.modal-header
                        button.close(data-dismiss="modal" aria-hidden="true") X
                    div.modal-body
                        form
                            textarea(name="editor2")
                    div.modal-footer
                        button.btn.btn-primary(data-dismiss="modal" ng-click='savePost()') Save
                        button.btn.btn-primary(data-dismiss="modal") Cancel
                        button.btn.btn-primary(data-dismiss="modal" ng-click='deletePost()') Delete
block script
    script(src="/ckeditor.js")
    //script CKEDITOR.replace('editor1', {customConfig: 'ckeditor/ckeditor-custom-config.js'});
    script CKEDITOR.replace('editor1', {customConfig: 'ckeditor/ckeditor-custom-config.js'});
    script CKEDITOR.replace('editor2', {customConfig: 'ckeditor/ckeditor-custom-config.js'});
    script(src="/js/postsApp.js")
    script(src="/js/controllers.js")
